# cpharmony.py

import pprint
import requests
from getpass import getpass


base_url_login = "https://cloudinfra-gw.ap.portal.checkpoint.com"
base_url_portal = "https://ap.portal.checkpoint.com"

threat_hunt_uri = "/app/threathunting/prod-gcp-apollo/"
threat_dash_uri = "/dashboard/endpoint/threathunting#/search"
login_uri = "/auth/user"

password = getpass()

payload = {
  "email": "greg.ford@intalock.com.au",
  "password": password,
  "captchaKey": "null"
}

# Login
url = base_url_portal + login_uri
session = requests.Session()
response = session.post(url=url, verify=False, json=payload)

print(response.status_code)

# Access the Threat Hunting page
url = base_url_portal + threat_dash_uri
session.get(url=url)

# Run the query
url = base_url_portal + threat_hunt_uri

payload = {
  "operationName": "searchRecords",
  "variables": {
    "indicators": [
      {
        "fieldArr": [
          "Active"
        ],
        "fieldType": "DetectionAttackStatus",
        "operator": "Is",
        "escaped": True
      }
    ],
    "queryParam": {
      "dateRange": {
        "from": "2022-10-25T14:00:00.000Z",
        "to": "2022-10-26T13:59:59.999Z"
      },
      "pagination": {
        "maxResults": 50,
        "pageToken": "null"
      },
      "aggregations": {
        "selectDistinct": False
      },
      "jobId": "null",
      "useRepCache": False,
      "orderBy": {
        "field": "OpTimeUTC",
        "ascDesc": "DESC"
      },
      "recordTypes": [
        "DetectionEvent"
      ],
      "dataSourceTypes": [
        "endpoint"
      ]
    },
    "includeRecordBase": True,
    "includeRecordProcess": False,
    "includeRecordFile": False,
    "includeRecordEmail": False,
    "includeRecordNetwork": False,
    "includeRecordRegistry": False,
    "includeRecordInject": False,
    "includeRecordRemoteLogon": False,
    "includeRecordScript": False,
    "includeDetectionEvent": True,
    "includeAdvancedActivity": False,
    "includeIndirectExecution": False,
    "includeRemoteExecution": False,
    "includeMTA": False,
    "includeGWStats": False,
    "includeLAAS": False,
    "includeMitre": True,
    "includeShadowIT": True
  },
  "query": "query searchRecords($indicators: [Indicator]!, $queryParam: QueryParam, $includeRecordBase: Boolean!, $includeRecordProcess: Boolean!, $includeRecordFile: Boolean!, $includeRecordNetwork: Boolean!, $includeRecordRegistry: Boolean!, $includeRecordInject: Boolean!, $includeRecordEmail: Boolean!, $includeRecordRemoteLogon: Boolean!, $includeRecordScript: Boolean!, $includeDetectionEvent: Boolean!, $includeMitre: Boolean!, $includeShadowIT: Boolean!, $includeAdvancedActivity: Boolean!, $includeIndirectExecution: Boolean!, $includeRemoteExecution: Boolean!, $includeGWStats: Boolean!, $includeMTA: Boolean!, $includeLAAS: Boolean!) {\n  searchRecords(indicators: $indicators, queryParam: $queryParam) {\n    pagination {\n      maxResults\n      pageToken\n      __typename\n    }\n    metadata {\n      totalRows\n      jobId\n      __typename\n    }\n    records {\n      ... on EPRecord {\n        DataSource\n        UUID\n        MachineName\n        UserName\n        OSName\n        HostType\n        OSVersion\n        ProductVersion\n        DomainName\n        EPGUID\n        HostIps\n        HostMacs\n        Base @include(if: $includeRecordBase) {\n          RecordType\n          Pid\n          CreationTime\n          PidCreationTime\n          OpTimeUTC\n          ProcessArgs\n          ProcessDir\n          ProcessName\n          ProcessPath\n          ProcessMD5\n          ProcessSigner\n          ProcessClassification\n          ParentProcessDir\n          ProcessTerminationTime\n          ParentProcessName\n          ParentProcessMD5\n          ParentProcessSigner\n          ParentProcessClassification\n          LogSource\n          Browser\n          BrowserVersion\n          ProcessReputationInfo {\n            ReputationType\n            Resource\n            ProcessClassification\n            ProcessRepPositives\n            ProcessRepTotal\n            ProcessRepRisk\n            ProcessRepConfidence\n            ProcessRepSeverity\n            ProcessRepMalwareFamily\n            ProcessRepMalwareTypes\n            ProcessRepProtectionName\n            VTLink\n            __typename\n          }\n          ParentProcessReputationInfo {\n            ReputationType\n            Resource\n            ProcessClassification\n            ProcessRepPositives\n            ProcessRepTotal\n            ProcessRepRisk\n            ProcessRepConfidence\n            ProcessRepSeverity\n            ProcessRepMalwareFamily\n            ProcessRepMalwareTypes\n            ProcessRepProtectionName\n            VTLink\n            __typename\n          }\n          __typename\n        }\n        Process @include(if: $includeRecordProcess) {\n          ProcessInvalidSigner\n          ProcessPPid\n          ProcessPCreationTime\n          ProcessPPidCreationTime\n          ProcessOp\n          ProcessIntegrityLevel\n          ProcessAccount\n          ProcessLogonSession\n          ParentProcessIntegrityLevel\n          ParentProcessArgs\n          ProcessTrustedSigner\n          ProcessOriginalName\n          __typename\n        }\n        Email @include(if: $includeRecordEmail) {\n          EmailFrom\n          EmailTo\n          EmailType\n          EmailSubject\n          EmailServerName\n          EmailMessageId\n          EmailCC\n          EmailBCC\n          EmailAttachments\n          EmailURLs\n          __typename\n        }\n        File @include(if: $includeRecordFile) {\n          FileDir\n          FileName\n          FileMD5\n          FileSize\n          FileType\n          FileNewDir\n          FileNewFileName\n          FileOpMask\n          FileOp\n          FileContent\n          FilePath\n          FileSigner\n          EmailFrom\n          EmailTo\n          EmailType\n          EmailSubject\n          EmailServerName\n          EmailMessageId\n          EmailCC\n          EmailBCC\n          OriginalFileClassification\n          FileReputationInfo {\n            ReputationType\n            Resource\n            FileClassification\n            FileRepPositives\n            FileRepTotal\n            FileRepRisk\n            FileRepConfidence\n            FileRepSeverity\n            FileRepMalwareFamily\n            FileRepMalwareTypes\n            FileRepProtectionName\n            VTLink\n            __typename\n          }\n          __typename\n        }\n        Network @include(if: $includeRecordNetwork) {\n          NetworkProtocol\n          NetworkDomain\n          NetworkHttpMethod\n          NetworkReferer\n          NetworkUserAgent\n          NetworkResponseStatusCode\n          NetworkSrcIP\n          NetworkSrcPort\n          NetworkDestIP\n          NetworkDestPort\n          NetworkIsListen\n          NetworkURL\n          NetworkDisplayedUrl\n          NetworkBytesSent\n          NetworkBytesReceived\n          NetworkType\n          NetworkConnectionDirection\n          FileName\n          FileMD5\n          EmailFrom\n          EmailTo\n          EmailType\n          EmailSubject\n          EmailServerName\n          EmailMessageId\n          EmailCC\n          EmailBCC\n          NetworkIsIframe\n          URLReputationInfo {\n            ReputationType\n            Resource\n            URLClassification\n            URLRepTotal\n            URLRepPositives\n            URLRepRisk\n            URLRepConfidence\n            URLRepSeverity\n            URLRepMalwareFamily\n            URLRepProtectionName\n            URLRepRegistrant\n            VTLink\n            __typename\n          }\n          DomainReputationInfo {\n            ReputationType\n            Resource\n            DomainClassification\n            DomainRepTotal\n            DomainRepPositives\n            DomainRepRisk\n            DomainRepConfidence\n            DomainRepSeverity\n            DomainRepMalwareFamily\n            DomainRepProtectionName\n            DomainRepRegistrant\n            VTLink\n            __typename\n          }\n          DestIPReputationInfo {\n            ReputationType\n            Resource\n            IPClassification\n            IPRepTotal\n            IPRepPositives\n            IPRepRisk\n            IPRepConfidence\n            IPRepSeverity\n            IPRepMalwareFamily\n            IPRepGeoLocation\n            VTLink\n            __typename\n          }\n          NetworkIsRemoteIpConnection\n          __typename\n        }\n        Registry @include(if: $includeRecordRegistry) {\n          RegistryKey\n          RegistryValue\n          RegistryNewData\n          RegistryOldData\n          RegistryOpMask\n          RegistryOp\n          __typename\n        }\n        Inject @include(if: $includeRecordInject) {\n          InjectDstPid\n          InjectDstCreationTime\n          InjectClassification\n          InjectDstDir\n          InjectDstName\n          InjectHookOperation\n          __typename\n        }\n        Script @include(if: $includeRecordScript) {\n          ScriptData\n          __typename\n        }\n        RemoteLogon @include(if: $includeRecordRemoteLogon) {\n          RemoteAttackerMachineName\n          RemoteOwnerUserName\n          RemoteOwnerDomainName\n          RemoteAttackerIpAddress\n          RemoteIpPort\n          RemoteLogonType\n          EventType\n          RemoteEventID\n          RemoteEventDescription\n          RemoteStatusDescription\n          RemoteSubStatusDescription\n          RemoteNumberOfConnections\n          LogonId\n          LinkedLogonId\n          UserSID\n          LogonOrigin\n          LogonAccountType\n          __typename\n        }\n        DetectionEvent @include(if: $includeDetectionEvent) {\n          DetectionIncidentId\n          DetectionAttackStatus\n          DetectionEnforcementMode\n          DetectionMalwareAction\n          DetectionTriggeredBy\n          DetectionThirdPartyVendorName\n          DetectionMalwareFamily\n          DetectionProtectionName\n          DetectionProtectionType\n          DetectionIncidentConfidence\n          DetectionIncidentSeverity\n          DetectionAttackTriggerProc\n          DetectionMaliciousPath\n          DetectionMaliciousFileDir\n          DetectionMaliciousFileName\n          DetectionMaliciousDomainName\n          DetectionTriggerMD5\n          DetectionEntryPointProc\n          DetectionAttackRoot\n          DetectionCreatingProcDir\n          DetectionCreatingProcName\n          DetectionCreatingProcMD5\n          DetectionCreatingProcSigner\n          DetectionCreatingProcPid\n          DetectionCreatingProcCreationTime\n          DetectionPolicyAutoRemidiation\n          DetectionGeneralInfo\n          DetectionDescription\n          DetectionRemediationPolicy\n          DetectionFirstEPNet\n          DetectionFirstEPURLReferrer\n          DetectionFirstEPFileName\n          DetectionFirstEPFileHash\n          DetectionAttackUserDomain\n          DetectionAttackUserName\n          DetectionImpersonatedDomain\n          DetectionImpersonatedType\n          DetectionImpersonatedBrand\n          DetectionEmailMsgID\n          DetectionEmailSubject\n          DetectionEmailFrom\n          DetectionEmailTo\n          DetectionEmailAttachmentName\n          DetectionEmailEmbeddedURL\n          DetectionEmailDateOfDelivery\n          __typename\n        }\n        AdvancedActivity @include(if: $includeAdvancedActivity) {\n          ActivityType\n          ActivityName\n          ActivityDetails\n          ActivityTargetProcessDir\n          ActivityTargetProcessName\n          ActivityTargetProcessArgs\n          ActivityTargetPid\n          ActivityTargetCreationTime\n          __typename\n        }\n        IndirectExecution @include(if: $includeIndirectExecution) {\n          ExecutionType\n          ExecutionName\n          ExecutionDetails\n          ExecutionTargetProcessDir\n          ExecutionTargetProcessName\n          ExecutionTargetProcessArgs\n          ExecutionTargetPid\n          ExecutionTargetCreationTime\n          ExecutionRemoteSourceMachine\n          ExecutionRemoteTargetUserName\n          ExecutionRemoteTargetUserDomain\n          __typename\n        }\n        RemoteExecution @include(if: $includeRemoteExecution) {\n          RemoteExecutionSourceIpAddress\n          RemoteExecutionSourcePort\n          RemoteExecutionSourceMachineName\n          RemoteExecutionDestinationIpAddress\n          RemoteExecutionDestinationPort\n          RemoteExecutionUserName\n          RemoteExecutionDomainName\n          RemoteExecutionUserSID\n          RemoteExecutionLogonId\n          RemoteExecutionType\n          __typename\n        }\n        MitreInfo @include(if: $includeMitre) {\n          tacticID\n          tacticName\n          techniqueID\n          techniqueName\n          __typename\n        }\n        ShadowITInfo @include(if: $includeShadowIT) {\n          applicationName\n          categoryName\n          subCategoryName\n          __typename\n        }\n        AggregationResults {\n          aggregationName\n          aggregateResult\n          __typename\n        }\n        __typename\n      }\n      ... on GWStatsRecord @include(if: $includeGWStats) {\n        DataSource\n        UUID\n        HostType\n        MachineName\n        UserName\n        OSName\n        OSVersion\n        Base {\n          RecordType\n          OpTimeUTC\n          GatewayName\n          __typename\n        }\n        Network {\n          NetworkType\n          NetworkURL\n          NetworkProtocol\n          NetworkDomain\n          NetworkSrcIP\n          NetworkSrcPort\n          NetworkDestIP\n          NetworkDestPort\n          NetworkConnectionDirection\n          NetworkReferer\n          NetworkResponseStatusCode\n          NetworkUserAgent\n          NetworkHttpMethod\n          FileMD5\n          URLReputationInfo {\n            ReputationType\n            Resource\n            URLClassification\n            URLRepTotal\n            URLRepPositives\n            URLRepRisk\n            URLRepConfidence\n            URLRepSeverity\n            URLRepMalwareFamily\n            URLRepProtectionName\n            URLRepRegistrant\n            VTLink\n            __typename\n          }\n          DomainReputationInfo {\n            ReputationType\n            Resource\n            DomainClassification\n            DomainRepTotal\n            DomainRepPositives\n            DomainRepRisk\n            DomainRepConfidence\n            DomainRepSeverity\n            DomainRepMalwareFamily\n            DomainRepProtectionName\n            DomainRepRegistrant\n            VTLink\n            __typename\n          }\n          DestIPReputationInfo {\n            ReputationType\n            Resource\n            IPClassification\n            IPRepTotal\n            IPRepPositives\n            IPRepRisk\n            IPRepConfidence\n            IPRepSeverity\n            IPRepMalwareFamily\n            IPRepGeoLocation\n            VTLink\n            __typename\n          }\n          __typename\n        }\n        File @include(if: $includeRecordFile) {\n          FileName\n          FileMD5\n          FileSize\n          FileReputationInfo {\n            ReputationType\n            Resource\n            FileClassification\n            FileRepPositives\n            FileRepTotal\n            FileRepRisk\n            FileRepConfidence\n            FileRepSeverity\n            FileRepMalwareFamily\n            FileRepMalwareTypes\n            FileRepProtectionName\n            VTLink\n            __typename\n          }\n          __typename\n        }\n        DetectionEvent @include(if: $includeDetectionEvent) {\n          DetectionAttackStatus\n          DetectionEnforcementMode\n          DetectionMalwareAction\n          DetectionTriggeredBy\n          DetectionMalwareFamily\n          DetectionProtectionName\n          DetectionIncidentConfidence\n          DetectionIncidentSeverity\n          DetectionMaliciousPath\n          DetectionMaliciousFileName\n          DetectionMaliciousDomainName\n          DetectionTriggerMD5\n          DetectionConnectionCount\n          DetectionRemediationPolicy\n          DetectionDescription\n          __typename\n        }\n        MitreInfo @include(if: $includeMitre) {\n          tacticID\n          tacticName\n          techniqueID\n          techniqueName\n          __typename\n        }\n        ShadowITInfo @include(if: $includeShadowIT) {\n          applicationName\n          categoryName\n          subCategoryName\n          __typename\n        }\n        __typename\n      }\n      ... on LAASRecord @include(if: $includeLAAS) {\n        DataSource\n        UUID\n        HostType\n        MachineName\n        UserName\n        OSName\n        OSVersion\n        Base {\n          RecordType\n          OpTimeUTC\n          GatewayBlade\n          GatewayName\n          GatewayPolicyMgmt\n          GatewayPolicyDate\n          GatewayPolicyName\n          GatewayPolicyRuleName\n          GatewayPolicyRuleNumber\n          GatewayPolicyRuleAction\n          __typename\n        }\n        Network {\n          NetworkType\n          NetworkURL\n          NetworkProtocol\n          NetworkDomain\n          NetworkSrcIP\n          NetworkSrcPort\n          NetworkDestIP\n          NetworkDestPort\n          NetworkConnectionDirection\n          NetworkReferer\n          NetworkResponseStatusCode\n          NetworkUserAgent\n          NetworkHttpMethod\n          NetworkBytesSent\n          NetworkBytesReceived\n          URLReputationInfo {\n            ReputationType\n            Resource\n            URLClassification\n            URLRepTotal\n            URLRepPositives\n            URLRepRisk\n            URLRepConfidence\n            URLRepSeverity\n            URLRepMalwareFamily\n            URLRepProtectionName\n            URLRepRegistrant\n            VTLink\n            __typename\n          }\n          DomainReputationInfo {\n            ReputationType\n            Resource\n            DomainClassification\n            DomainRepTotal\n            DomainRepPositives\n            DomainRepRisk\n            DomainRepConfidence\n            DomainRepSeverity\n            DomainRepMalwareFamily\n            DomainRepProtectionName\n            DomainRepRegistrant\n            VTLink\n            __typename\n          }\n          DestIPReputationInfo {\n            ReputationType\n            Resource\n            IPClassification\n            IPRepTotal\n            IPRepPositives\n            IPRepRisk\n            IPRepConfidence\n            IPRepSeverity\n            IPRepMalwareFamily\n            IPRepGeoLocation\n            VTLink\n            __typename\n          }\n          __typename\n        }\n        File @include(if: $includeRecordFile) {\n          FileName\n          FileMD5\n          FileSize\n          FileReputationInfo {\n            ReputationType\n            Resource\n            FileClassification\n            FileRepPositives\n            FileRepTotal\n            FileRepRisk\n            FileRepConfidence\n            FileRepSeverity\n            FileRepMalwareFamily\n            FileRepMalwareTypes\n            FileRepProtectionName\n            VTLink\n            __typename\n          }\n          __typename\n        }\n        DetectionEvent @include(if: $includeDetectionEvent) {\n          DetectionAttackStatus\n          DetectionEnforcementMode\n          DetectionMalwareAction\n          DetectionTriggeredBy\n          DetectionMalwareFamily\n          DetectionProtectionName\n          DetectionIncidentConfidence\n          DetectionIncidentSeverity\n          DetectionMaliciousPath\n          DetectionMaliciousFileName\n          DetectionMaliciousDomainName\n          DetectionTriggerMD5\n          DetectionConnectionCount\n          DetectionRemediationPolicy\n          DetectionDescription\n          DetectionSuppressedLogs\n          __typename\n        }\n        MitreInfo @include(if: $includeMitre) {\n          tacticID\n          tacticName\n          techniqueID\n          techniqueName\n          __typename\n        }\n        ShadowITInfo @include(if: $includeShadowIT) {\n          applicationName\n          categoryName\n          subCategoryName\n          __typename\n        }\n        __typename\n      }\n      ... on MTARecord @include(if: $includeMTA) {\n        DataSource\n        OSName\n        HostType\n        Base {\n          AssetType\n          OpTimeSecondsUTC\n          Domain\n          OpTimeUTC\n          RecordType\n          OSVersion\n          HostType\n          MachineName\n          UserName\n          __typename\n        }\n        DetectionEvent @include(if: $includeDetectionEvent) {\n          DetectionEventType\n          DetectionAttackStatus\n          DetectionEnforcementMode\n          DetectionMalwareAction\n          DetectionTriggeredBy\n          DetectionMalwareFamily\n          DetectionProtectionName\n          DetectionProtectionType\n          DetectionIncidentConfidence\n          DetectionIncidentSeverity\n          DetectionMaliciousFileName\n          DetectionMaliciousDomainName\n          DetectionTriggerMD5\n          DetectionTriggerURL\n          DetectionDescription\n          DetectionEmailMsgID\n          DetectionEmailSubject\n          DetectionEmailFrom\n          DetectionEmailTo\n          DetectionEmailAttachmentName\n          DetectionEmailDateOfDelivery\n          DetectionMaliciousPath\n          __typename\n        }\n        File @include(if: $includeRecordFile) {\n          FileName\n          FileMD5\n          FileSha1\n          FileType\n          FileSize\n          OriginalFileClassification\n          FileReputationInfo {\n            ReputationType\n            Resource\n            FileClassification\n            FileRepPositives\n            FileRepTotal\n            FileRepRisk\n            FileRepConfidence\n            FileRepSeverity\n            FileRepMalwareFamily\n            FileRepMalwareTypes\n            FileRepProtectionName\n            VTLink\n            __typename\n          }\n          __typename\n        }\n        Network @include(if: $includeRecordNetwork) {\n          NetworkSrcIP\n          NetworkURL\n          NetworkAction\n          NetworkDomain\n          NetworkType\n          URLReputationInfo {\n            ReputationType\n            Resource\n            URLClassification\n            URLRepTotal\n            URLRepPositives\n            URLRepRisk\n            URLRepConfidence\n            URLRepSeverity\n            URLRepMalwareFamily\n            URLRepProtectionName\n            URLRepRegistrant\n            VTLink\n            __typename\n          }\n          DomainReputationInfo {\n            ReputationType\n            Resource\n            DomainClassification\n            DomainRepTotal\n            DomainRepPositives\n            DomainRepRisk\n            DomainRepConfidence\n            DomainRepSeverity\n            DomainRepMalwareFamily\n            DomainRepProtectionName\n            DomainRepRegistrant\n            VTLink\n            __typename\n          }\n          DestIPReputationInfo {\n            ReputationType\n            Resource\n            IPClassification\n            IPRepTotal\n            IPRepPositives\n            IPRepRisk\n            IPRepConfidence\n            IPRepSeverity\n            IPRepMalwareFamily\n            IPRepGeoLocation\n            VTLink\n            __typename\n          }\n          __typename\n        }\n        Email {\n          EmailRule\n          EmailStatus\n          EmailClassification\n          EmailReason\n          EmailId\n          EmailTo\n          EmailFrom\n          EmailSrcIP\n          EmailStatus\n          EmailSubject\n          EmailQueueId\n          EmailReplyTo\n          EmailMessageId\n          EmailAttachments\n          EmailURLsCount\n          EmailRecipientsNum\n          EmailSourceCountry\n          EmailInspectionType\n          EmailConfidence\n          __typename\n        }\n        __typename\n      }\n      ... on MobileRecord {\n        DataSource\n        UUID\n        OSName\n        HostType\n        OSVersion\n        ProductVersion\n        MachineName\n        HostType\n        UserName\n        Base {\n          DeviceRisk\n          RecordType\n          OpTimeUTC\n          DeviceID\n          DeviceVendor\n          Model\n          DeviceModel\n          HardwareModel\n          ONPVersion\n          ONPProtection\n          SSLInspection\n          SafeDNSProtection\n          LocationLatitude\n          LocationLongitude\n          Location\n          Locale\n          LocaleDisplayName\n          RootingJB\n          USBDebugging\n          DeviceEncryption\n          ScreenLockProtection\n          VerifiedBoot\n          SELinux\n          MDMVendor\n          MDMDeviceID\n          ManagedDevice\n          ManagedDeviceType\n          ExternalIP\n          Wifi\n          Cellular\n          __typename\n        }\n        DetectionEvent {\n          DetectionTriggeredBy\n          DetectionAttackStatus\n          DetectionMaliciousPath\n          EventTrigger\n          EventDetails\n          ThreatFactors\n          AttackVector\n          OldRiskLevel\n          NewRiskLevel\n          ONPAction\n          ONPActionReason\n          IsOtherVPNAlwaysOn\n          __typename\n        }\n        Network {\n          NetworkType\n          NetworkEventType\n          NetworkSrcPort\n          NetworkDestIP\n          NetworkDestPort\n          NetworkProtocol\n          AppProtocol\n          SSLVersion\n          SSLPeerCertCN\n          SSLPeerCertSHA256\n          SSLValidity\n          SourceAppID\n          SourceAppSHA256\n          NetworkDomain\n          OpenTime\n          CloseTime\n          NetworkBytesSent\n          NetworkBytesReceived\n          DNSResponse\n          DNSRequestedType\n          NetworkReferer\n          NetworkUserAgent\n          NetworkHttpMethod\n          HttpMimeType\n          IsBrowser\n          ReputationRisk\n          ReputationSafe\n          ReputationCategories\n          NetworkURL\n          ZPPageIndicators\n          ZPUniqueID\n          ZPVerdictRisk\n          ZPVerdictUUID\n          ZPVerdictImpostureTargetBrand\n          ZPVerdictImpostureTargetDomain\n          ZPVerdictImpostureTargetType\n          ZPAction\n          InjectionTime\n          ScanTime\n          URLReputationInfo {\n            ReputationType\n            Resource\n            URLClassification\n            URLRepTotal\n            URLRepPositives\n            URLRepRisk\n            URLRepConfidence\n            URLRepSeverity\n            URLRepMalwareFamily\n            URLRepProtectionName\n            URLRepRegistrant\n            VTLink\n            __typename\n          }\n          DomainReputationInfo {\n            ReputationType\n            Resource\n            DomainClassification\n            DomainRepTotal\n            DomainRepPositives\n            DomainRepRisk\n            DomainRepConfidence\n            DomainRepSeverity\n            DomainRepMalwareFamily\n            DomainRepProtectionName\n            DomainRepRegistrant\n            VTLink\n            __typename\n          }\n          DestIPReputationInfo {\n            ReputationType\n            Resource\n            IPClassification\n            IPRepTotal\n            IPRepPositives\n            IPRepRisk\n            IPRepConfidence\n            IPRepSeverity\n            IPRepMalwareFamily\n            IPRepGeoLocation\n            VTLink\n            __typename\n          }\n          __typename\n        }\n        NetworkRoaming {\n          JoinTime\n          NetworkInterfaceType\n          WifiSSID\n          WifiBSSID\n          DefaultGatewayIP\n          NetworkOperator\n          NetworkOperatorName\n          SimCarrierId\n          SimCarrierIdName\n          SimOperator\n          SimOperatorName\n          SimSpecificCarrierId\n          SimSpecificCarrierIdName\n          __typename\n        }\n        Application {\n          AppActionTime\n          AppAction\n          AppID\n          AppPackageName\n          AppVersion\n          AppInstallationSource\n          AppCertificate\n          __typename\n        }\n        __typename\n      }\n      __typename\n    }\n    __typename\n  }\n}\n"
}


response = session.post(url=url, verify=False, json=payload)

print(response.status_code)
# print(response.content)
print(response.text)